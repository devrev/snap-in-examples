---
title: 'Custom Keyring Types'
description: 'A guide to creating custom keyring types in a snap-in manifest, with examples for basic authentication, OAuth 2.0, multi-field secrets, and referencing existing types.'
---

## Introduction

This guide demonstrates how to create custom keyring types to connect to third-party services. Custom keyring types allow you to define your own connection types, including support for different authentication methods and custom UI. This example includes four different types of custom keyrings:
- Basic authentication
- OAuth 2.0
- Multi-field secrets
- Referencing existing keyring types

### Prerequisites
- A DevRev account with the CLI installed and configured.

## Setup

This section guides you on setting up a new snap-in project to use custom keyring types.

1.  **Initialize the project:** Run `devrev snap_in_version init <project_name>` to create a new project directory with a template structure.
2.  **Update the manifest:** Modify the `manifest.yaml` file to include your `keyring_types` definition, using the examples below as a reference.
3.  **Validate the manifest:** Before deploying, check your manifest by running `devrev snap_in_version validate-manifest manifest.yaml`.

## Keyring Type Examples

Below are four examples of how to define custom keyring types in your `manifest.yaml`.

### Basic Authentication

This example shows how to create a custom keyring type for a service that uses basic authentication, such as Freshdesk. The manifest defines the required fields and how to transform them into a standard `Authorization: Basic` header.

```yaml
# Example: custom-keyring-type-basic.yaml
version: "2"
name: "Custom Keyring Type Snap-in"
description: "Creating custom keyring type for Freshdesk Basic connection"

keyrings:
    organization:
      - name: freshdesk_connection
        display_name: Freshdesk connection (must be set up as dev org connection)
        description: The Freshdesk app connection for the organization.
        types:
            - freshdesk-basic-connection

keyring_types:
  - id: freshdesk-basic-connection
    name: Freshdesk Connection
    description: Freshdesk connection
    kind: "Secret"
    is_subdomain: true # The is_subdomain field is used to indicate that the subdomain is part of the URL.
    secret_config: # The secret_config section is used to define the fields in the secret.
      secret_transform: ".token+\":X\" | @base64" # The secret_config section is used to transform data from the input fields into the secret value (token).
      fields: # optional: data that the user shall provide in the input form when creating the connection. Each element represents one input field. Fields will be included in the final JSON secret. If omitted, the user will be asked for a generic secret.
        - id: token
          name: Token
          description: Freshdesk API token
      token_verification: # The token_verification section is used to verify the token provided by the user.
        url: "https://[SUBDOMAIN].freshdesk.com/api/v2/tickets"
        method: "GET"
        headers:
          Authorization: "Basic [API_KEY]"
```

### OAuth 2.0

This example shows how to create a custom keyring type for a service that uses OAuth 2.0, such as GitLab. It defines the necessary URLs, scopes, and secrets for the OAuth flow.

```yaml
# Example: custom-keyring-type-oauth.yaml
version: "2"
name: "Custom Keyring Type Snap-in"
description: "Creating custom keyring type for GitLab OAuth connection"

service_account:
  display_name: DevRev Bot

developer_keyrings:
  - name: gitlab-oauth-secret
    description: GitLab OAuth secret
    display_name: GitLab OAuth secret

keyrings:
  organization:
    - name: gitlab_connection
      display_name: GitLab connection (must be set up as dev org connection)
      description: The gitlab app connection for the organization.
      types:
        - gitlab-oauth-connection

keyring_types:
  - id: gitlab-oauth-connection
    name: "GitLab Connection"
    description: "GitLab connection"
    kind: "Oauth2"
    scopes:
      - name: read
        description: Read access
        value: "read_api"
      - name: api
        description: API access
        value: "api"
    scope_delimiter: " "
    oauth_secret: gitlab-oauth-secret
    authorize:
      type: "config"
      auth_url: "https://gitlab.com/oauth/authorize"
      token_url: "https://gitlab.com/oauth/token"
      grant_type: "authorization_code"
      auth_query_parameters:
        "client_id": "[CLIENT_ID]"
        "scope": "[SCOPES]"
        "response_type": "code"
      token_query_parameters:
        "client_id": "[CLIENT_ID]"
        "client_secret": "[CLIENT_SECRET]"
    refresh:
      type: "config"
      url: "https://gitlab.com/api/oauth.v2.access"
      method: "POST"
      query_parameters:
        "client_id": "[CLIENT_ID]"
        "client_secret": "[CLIENT_SECRET]"
        "refresh_token": "[REFRESH_TOKEN]"
      headers:
        "Content-type": "application/x-www-form-urlencoded"
    revoke:
      type: "config"
      url: "https://gitlab.com/oauth/revoke"
      method: "POST"
      headers:
        "Content-type": "application/x-www-form-urlencoded"
      query_parameters:
        "client_id": "[CLIENT_ID]"
        "client_secret": "[CLIENT_SECRET]"
        "token": "[ACCESS_TOKEN]"
```

### Multi-field Secrets

This example shows how to create a custom keyring type for a secret that has multiple fields, such as a username and password.

```yaml
# Example: custom-keyring-type-secret.yaml
version: "2"
name: "Custom Keyring Type Snap-in"
description: "Creating custom keyring type for Multi Field Secret"

keyrings:
  organization:
    - name: multi_field_secret
      display_name: Multi Field Secret
      description: The multi field secret for the organization.
      types:
        - multi-field-secret

keyring_types:
  - id: multi-field-secret
    name: Multi Field Secret
    description: Multi Field Secret
    kind: "Secret"
    secret_config:
      fields:
        - id: username
          name: Username
          description: Username
        - id: password
          name: Password
          description: Password
          is_optional: true
```

### Referencing Existing Keyring Types

This example shows how to create a custom keyring type that references an existing, built-in keyring type. This is useful for extending existing connection types with additional scopes or settings.

```yaml
# Example: reference-keyring-type.yaml
version: "2"
name: "Reference Keyring Type Snap-in"
description: "Creating the keyring type for Slack connection with reference to the existing Slack connection"

service_account:
  display_name: DevRev Bot

developer_keyrings:
  - name: slack-oauth-secret
    description: Slack OAuth secret
    display_name: Slack OAuth secret

keyrings:
  organization:
    - name: slack_connection
      display_name: Slack connection (must be set up as dev org connection)
      description: The slack app connection for the organization.
      types:
        - slack-oauth-connection

keyring_types:
  - id: slack-oauth-connection
    name: Slack Connection
    description: Slack connection
    kind: "Oauth2"
    scopes:
      - name: read
        description: App mentions read only access
        value: app_mentions:read
      - name: write
        description: App channels history read only access
        value: "channels:history"
    scope_delimiter: ","
    oauth_secret: slack-oauth-secret
    reference_keyring: devrev-slack-oauth
```
