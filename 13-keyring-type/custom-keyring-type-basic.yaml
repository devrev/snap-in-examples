version: "2"
name: "Custom Keyring Type Snap-in"
description: "Creating custom keyring type for Freshdesk Basic connection"

# This is the name displayed in DevRev where the Snap-In takes actions using the token of this service account.
service_account:
  display_name: DevRev Bot

keyrings:
    organization:
      - name: freshdesk_connection
        display_name: Freshdesk connection (must be set up as dev org connection)
        description: The Freshdesk app connection for the organization.
        types:
            - freshdesk-basic-connection

keyring_types:
  - id: freshdesk-basic-connection
    name: Freshdesk Connection
    description: Freshdesk connection
    kind: "Secret"
    is_subdomain: true # The is_subdomain field is used to indicate that the subdomain is part of the URL.
    secret_config: # The secret_config section is used to define the fields in the secret.
      secret_transform: ".token+\":X\" | @base64" # The secret_config section is used to transform data from the input fields into the secret value (token).
      fields: # The fields section is used to define the input fields for the user.
        - id: token
          name: Token
          description: Freshdesk API token
      token_verification: # The token_verification section is used to verify the token provided by the user.
        url: "https://[SUBDOMAIN].freshdesk.com/api/v2/tickets"
        method: "GET"
        headers:
          Authorization: "Basic [API_KEY]"