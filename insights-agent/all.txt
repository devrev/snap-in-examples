curl 'https://api.dev.devrev-eng.ai/internal/workflows.create' \
  -H 'accept: application/json, text/plain, */*' \
  -H 'content-type: application/json' \
  -H 'authorization: auth' \
  --data-raw '{"title":"Insights Agent"}'

  // don:integration:dvrv-us-1:devo/787:workflow/625


curl 'https://api.dev.devrev-eng.ai/internal/workflow-steps.create' \
  -H 'accept: application/json, text/plain, */*' \
  -H 'authorization: auth' \
  -H 'content-type: application/json' \
  --data-raw '{
  "description":"Manually triggers the workflow",
  "name":"Manual Trigger",
  "operation":"don:integration:dvrv-us-1:operation/devrev.manual_trigger",
  "ui_metadata":{"position":{"x":0,"y":0}},
  "workflow":"don:integration:dvrv-us-1:devo/787:workflow/625",
  	"output_ports": [
		{
			"name": "output",
			"schema": {
				"field_descriptors": [
					{
						"field_type": "id",
						"db_name": "agent_session_id",
						"description": "The ID of the agent session",
						"id_type": [
							"ai_agent_session"
						],
						"is_required": true,
						"name": "agent_session_id"
					},
					{
						"field_type": "text",
						"db_name": "skill_call_id",
						"description": "The ID of the skill call being executed",
						"is_required": true,
						"name": "skill_call_id"
					},
					{
						"field_type": "text",
						"db_name": "skill_name",
						"description": "The name of the skill being executed",
						"is_required": true,
						"name": "skill_name"
					},
					{
						"field_type": "text",
						"db_name": "sql_query",
						"description": "The query",
						"is_required": true,
						"name": "sql_query"
					}
				],
				"type": "field_descriptor"
			}
		}
	],
	"reference_key": "ai_agent_skill_manual_trigger"
  }'

  // don:integration:dvrv-us-1:devo/787:workflow/625:workflow_step/625.4207


  curl 'https://api.dev.devrev-eng.ai/internal/workflow-steps.create' \
  -H 'accept: application/json, text/plain, */*' \
  -H 'authorization: auth' \
  -H 'content-type: application/json' \
  --data-raw '{
  "description":"Executes a SQL query on an Oasis dataset",
  "name":"Oasis Sql Execute",
  "operation":"don:integration:dvrv-us-1:operation/devrev.oasis_sql_execute",
  "reference_key":"oasis_sql_execute_1",
  "ui_metadata":{"position":{"x":150,"y":150}},
  "workflow":"don:integration:dvrv-us-1:devo/787:workflow/625"
}'

// don:integration:dvrv-us-1:devo/787:workflow/625:workflow_step/625.4208


curl 'https://api.dev.devrev-eng.ai/internal/workflow-steps.update' \
  -H 'accept: application/json, text/plain, */*' \
  -H 'authorization: auth' \
  -H 'content-type: application/json' \
  --data-raw '{"id":"don:integration:dvrv-us-1:devo/787:workflow/625:workflow_step/625.4207","next_steps":[{"next_port_name":"input","next_step":"don:integration:dvrv-us-1:devo/787:workflow/625:workflow_step/625.4208","port_name":"output"}]}'


  curl 'https://api.dev.devrev-eng.ai/internal/workflow-steps.update' \
  -H 'accept: application/json, text/plain, */*' \
  -H 'authorization: auth' \
  -H 'content-type: application/json' \
  --data-raw $'{"id":"don:integration:dvrv-us-1:devo/787:workflow/625:workflow_step/625.4208","input_values":[{"fields":[{"name":"sql_query","value":{"type":"text_template","value":"{% expr $get(\'ai_agent_skill_manual_trigger\', \'output\').sql_query %}"}}],"port_name":"input"}]}'


  curl 'https://api.dev.devrev-eng.ai/internal/workflow-steps.create' \
  -H 'accept: application/json, text/plain, */*' \
  -H 'content-type: application/json' \
    -H 'authorization: auth' \
  --data-raw '{
  "description":"Takes the output of the retriever workflow and returns it to the agent.",
  "input_ports":[],
  "name":"Agent Callback",
  "operation":"don:integration:dvrv-us-1:operation/devrev.agent_callback",
  "output_ports":[],
  "previous_steps":[{"id":"don:integration:dvrv-us-1:devo/787:workflow/625:workflow_step/625.4208","port_name":"input","previous_port_name":"output"}],
  "reference_key":"agent_callback_1",
  "ui_metadata":{"position":{"x":131.04396243666662,"y":339.33979195007873}},
  "workflow":"don:integration:dvrv-us-1:devo/787:workflow/625",
  "input_values": [
        {
            "fields": [
                {
                    "name": "agent_session_id",
                    "value": {
                        "type": "jsonata_expression",
                        "value": "$get('\''ai_agent_skill_manual_trigger'\'', '\''output'\'').agent_session_id"
                    }
                },
                {
                    "name": "skill_call_id",
                    "value": {
                        "type": "jsonata_expression",
                        "value": "$get('\''ai_agent_skill_manual_trigger'\'', '\''output'\'').skill_call_id"
                    }
                },
                {
                    "name": "skill_name",
                    "value": {
                        "type": "jsonata_expression",
                        "value": "$get('\''ai_agent_skill_manual_trigger'\'', '\''output'\'').skill_name"
                    }
                },
                {
                    "name": "output",
                    "value": {
                        "type": "jsonata_expression",
                        "value": "$get('\''oasis_sql_execute_1'\'', '\''output'\'')"
                    }
                }
            ],
            "port_name": "input"
        }
    ]
}'
